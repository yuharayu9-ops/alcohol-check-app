<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯å ±å‘Š</title>
    <style>
        body { font-family: sans-serif; background-color: #eef9ff; margin: 0; padding: 10px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #0077b6; border-bottom: 3px solid #caf0f8; padding-bottom: 10px; }
        .section-title { font-weight: bold; margin: 20px 0 10px; color: #023e8a; border-left: 8px solid #00b4d8; padding-left: 12px; }
        .btn-group { display: grid; gap: 8px; margin-bottom: 10px; grid-template-columns: 1fr 1fr; }
        .select-btn { padding: 18px 10px; border: 3px solid #e0e0e0; border-radius: 15px; background: #fff; cursor: pointer; font-size: 1.1em; font-weight: bold; text-align: center; color: #444; }
        .select-btn.active { background: #0077b6; color: white; border-color: #023e8a; }
        /* è­¦å‘Šæ–‡ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        #alcohol-alert { display: none; background-color: #ff0000; color: white; padding: 15px; border-radius: 12px; margin-top: 10px; font-weight: bold; text-align: center; border: 3px solid #b30000; }
        textarea { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 12px; box-sizing: border-box; font-size: 16px; }
        .submit-btn { width: 100%; padding: 22px; background: #023e8a; color: white; border: none; border-radius: 60px; font-size: 1.5em; font-weight: bold; margin-top: 30px; }
    </style>
</head>
<body>
<div class="container">
    <h2>ğŸšš ç‚¹å‘¼å ±å‘Š</h2>
    <div class="section-title">â° æœãƒ»å¤•</div>
    <div class="btn-group">
        <div class="select-btn active" onclick="sel('check_type','æœ',this)">æœ</div>
        <div class="select-btn" onclick="sel('check_type','å¤•',this)">å¤•</div>
    </div>
    <div class="section-title">ğŸ‘¤ åå‰</div><div id="driver-buttons" class="btn-group"></div>
    <div class="section-title">ğŸš— è»Šä¸¡ï¼ˆæœªé¸æŠãªã‚‰æœªå®šï¼‰</div><div id="car-buttons" class="btn-group" style="grid-template-columns: 1fr;"></div>
    <div class="section-title">ğŸ“± æ¤œçŸ¥å™¨</div>
    <div class="btn-group">
        <div class="select-btn active" onclick="sel('use_device','ä½¿ç”¨',this)">ä½¿ç”¨</div>
        <div class="select-btn" onclick="sel('use_device','æœªä½¿ç”¨',this)">æœªä½¿ç”¨</div>
    </div>
    <div class="section-title">ğŸ· é…’æ°—å¸¯ã³</div>
    <div class="btn-group">
        <div class="select-btn active" onclick="selAlc('ç„¡',this)">ç„¡</div>
        <div class="select-btn" onclick="selAlc('æœ‰',this)">æœ‰</div>
    </div>
    <div id="alcohol-alert">ğŸš¨ ç•°å¸¸æ¤œçŸ¥ï¼ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚ç›´ã¡ã«é‹è¡Œç®¡ç†è€…ã«å ±å‘Šã—ã€æŒ‡ç¤ºã‚’ä»°ã„ã§ãã ã•ã„ã€‚</div>

    <div class="section-title">ğŸ‘® ç¢ºèªè€…</div><div id="checker-buttons" class="btn-group"></div>
    <div class="section-title">ğŸ“ å‚™è€ƒ</div>
    <textarea id="instruction" rows="3" placeholder="å‚™è€ƒãŒã‚ã‚Œã°è¨˜å…¥"></textarea>
    <button class="submit-btn" onclick="sub()">å ±å‘Šã‚’é€ä¿¡ï¼</button>
</div>
<script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxUiEfp_FRoH98--XLr7-bnuo5gGIQEA7am1SknZOSINJGzaKa4V3E6dXiqWl3o7vbq/exec";
    let formData = { check_type:"æœ", driver_name:"", car_number:"æœªå®š", method:"å¯¾é¢", use_device:"ä½¿ç”¨", has_alcohol:"ç„¡", checker_name:"" };
    
    window.onload = async () => {
        const res = await fetch(GAS_URL); const d = await res.json();
        const create = (list, gid, key) => {
            const g = document.getElementById(gid);
            list.forEach((v, i) => {
                const b = document.createElement('div'); b.className = 'select-btn'; b.innerText = v;
                b.onclick = () => sel(key, v, b); g.appendChild(b);
                if (key === 'checker_name' && i === 0) { b.classList.add('active'); formData.checker_name = v; }
            });
        };
        create(d.drivers, 'driver-buttons', 'driver_name'); create(d.cars, 'car-buttons', 'car_number'); create(d.checkers, 'checker-buttons', 'checker_name');
    };

    function sel(k, v, e) { 
        formData[k] = v; 
        e.parentElement.querySelectorAll('.select-btn').forEach(b => b.classList.remove('active')); 
        e.classList.add('active'); 
    }

    // é…’æ°—å¸¯ã³å°‚ç”¨ã®é¸æŠé–¢æ•°ï¼ˆã‚¢ãƒ©ãƒ¼ãƒˆé€£å‹•ï¼‰
    function selAlc(v, e) {
        formData.has_alcohol = v;
        e.parentElement.querySelectorAll('.select-btn').forEach(b => b.classList.remove('active'));
        e.classList.add('active');
        const alertBox = document.getElementById('alcohol-alert');
        alertBox.style.display = (v === 'æœ‰') ? 'block' : 'none';
    }

    async function sub() {
        if (!formData.driver_name) return alert("åå‰ã‚’é¸ã‚“ã§ãã ã•ã„");
        const b = document.querySelector('.submit-btn'); b.disabled = true; b.innerText = "é€ä¿¡ä¸­...";
        formData.instruction = document.getElementById('instruction').value;
        await fetch(GAS_URL, { method: "POST", mode: "no-cors", body: JSON.stringify(formData) });
        alert("é€ä¿¡å®Œäº†ï¼"); location.reload();
    }
</script>
</body>
</html>
