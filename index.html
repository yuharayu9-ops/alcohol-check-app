<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯å ±å‘Š</title>
    <style>
        body { font-family: sans-serif; background-color: #eef9ff; margin: 0; padding: 10px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #0077b6; border-bottom: 3px solid #caf0f8; padding-bottom: 10px; }
        .section-title { font-weight: bold; margin: 20px 0 10px; color: #023e8a; border-left: 8px solid #00b4d8; padding-left: 12px; }
        .btn-group { display: grid; gap: 8px; margin-bottom: 10px; }
        .grid-2 { grid-template-columns: 1fr 1fr; }
        .grid-1 { grid-template-columns: 1fr; }
        .select-btn { padding: 18px 10px; border: 3px solid #e0e0e0; border-radius: 15px; background: #fff; cursor: pointer; font-size: 1.1em; font-weight: bold; text-align: center; color: #444; box-shadow: 0 4px 0 #ddd; }
        .select-btn.active { background: #0077b6; color: white; border-color: #023e8a; box-shadow: 0 4px 0 #005f8b; }
        .select-btn.danger.active { background: #d90429; border-color: #a4133c; box-shadow: 0 4px 0 #800e13; }
        .select-btn.type-btn.active { background: #ff9f1c; border-color: #f3722c; box-shadow: 0 4px 0 #e67e22; }
        textarea { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 12px; box-sizing: border-box; font-size: 16px; }
        .submit-btn { width: 100%; padding: 22px; background: #023e8a; color: white; border: none; border-radius: 60px; font-size: 1.5em; font-weight: bold; cursor: pointer; margin-top: 30px; box-shadow: 0 6px 0 #001a33; }
        #loading { text-align: center; padding: 50px; font-weight: bold; }
        #alcohol-alert { display:none; color:white; background:#d90429; text-align:center; padding:15px; border-radius:10px; margin-top:10px; font-weight:bold; }
    </style>
</head>
<body>
<div class="container">
    <h2>ğŸšš ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯å ±å‘Š</h2>
    <div id="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
    <div id="form-content" style="display:none;">
        <div class="section-title">â° æœãƒ»å¤•ã®é¸æŠ</div>
        <div class="btn-group grid-2">
            <div class="select-btn type-btn active" onclick="select('check_type', 'ä¹—å‹™å‰(æœ)', this)">ä¹—å‹™å‰ (æœ)</div>
            <div class="select-btn type-btn" onclick="select('check_type', 'ä¹—å‹™å¾Œ(å¤•)', this)">ä¹—å‹™å¾Œ (å¤•)</div>
        </div>
        <div class="section-title">ğŸ‘¤ é‹è»¢è€…</div><div id="driver-buttons" class="btn-group grid-2"></div>
        <div class="section-title">ğŸš— è»Šä¸¡ï¼ˆæœªå®šãªã‚‰æ¬¡ã¸ï¼‰</div><div id="car-buttons" class="btn-group grid-1"></div>
        <div class="section-title">ğŸ“± ç¢ºèªãƒ»æ¤œçŸ¥å™¨</div>
        <div class="btn-group grid-2">
            <div class="select-btn method-btn active" onclick="select('method', 'å¯¾é¢', this)">å¯¾é¢</div>
            <div class="select-btn method-btn" onclick="select('method', 'é›»è©±', this)">é›»è©±</div>
        </div>
        <div class="btn-group grid-2">
            <div class="select-btn device-btn active" onclick="select('use_device', 'ä½¿ç”¨', this)">æ¤œçŸ¥å™¨ï¼šä½¿ç”¨</div>
            <div class="select-btn device-btn" onclick="select('use_device', 'æœªä½¿ç”¨', this)">æœªä½¿ç”¨</div>
        </div>
        <div class="section-title">ğŸ· é…’æ°—å¸¯ã³</div>
        <div class="btn-group grid-2">
            <div class="select-btn alcohol-btn active" onclick="selectAlcohol('ç„¡', this)">ç„¡ (æ­£å¸¸)</div>
            <div class="select-btn alcohol-btn danger" onclick="selectAlcohol('æœ‰', this)">æœ‰ (ç•°å¸¸)</div>
        </div>
        <div id="alcohol-alert">âš ï¸ é…’æ°—å¸¯ã³ã€Œæœ‰ã€ã§ã™ï¼é‹è¡Œç®¡ç†è€…ã«é€£çµ¡ã—ã¦ãã ã•ã„ã€‚</div>
        <div class="section-title">ğŸ‘® ç¢ºèªè€…</div><div id="checker-buttons" class="btn-group grid-2"></div>
        <div class="section-title">ğŸ“ å‚™è€ƒ</div><textarea id="instruction" rows="2"></textarea>
        <button class="submit-btn" onclick="submitForm()">å ±å‘Šã‚’é€ä¿¡ï¼</button>
    </div>
</div>
<script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycby-LQNz4c7dCHRVKRWtGKhefc6TmUJ38eseiorVA2v0toW5ZfDUeI5nAOfU7yQr_tOrqA/exec";
    let formData = { check_type: "ä¹—å‹™å‰(æœ)", driver_name: "", car_number: "æœªå®š", method: "å¯¾é¢", use_device: "ä½¿ç”¨", has_alcohol: "ç„¡", checker_name: "" };
    window.onload = async () => {
        try {
            const res = await fetch(GAS_URL); const data = await res.json();
            const createSection = (list, gid, key) => {
                const g = document.getElementById(gid);
                list.forEach((item, i) => {
                    const b = document.createElement('div'); b.className = 'select-btn'; b.innerText = item;
                    b.onclick = () => select(key, item, b); g.appendChild(b);
                    if (key === 'checker_name' && i === 0) { b.classList.add('active'); formData.checker_name = item; }
                });
            };
            createSection(data.drivers, 'driver-buttons', 'driver_name');
            createSection(data.cars, 'car-buttons', 'car_number');
            createSection(data.checkers, 'checker-buttons', 'checker_name');
            document.getElementById('loading').style.display = 'none'; document.getElementById('form-content').style.display = 'block';
        } catch (e) { document.getElementById('loading').innerText = "èª­ã¿è¾¼ã¿å¤±æ•—"; }
    };
    function select(k, v, e) { formData[k] = v; e.parentElement.querySelectorAll('.select-btn').forEach(b => b.classList.remove('active')); e.classList.add('active'); }
    function selectAlcohol(v, e) {
        formData.has_alcohol = v; select('has_alcohol', v, e);
        document.getElementById('alcohol-alert').style.display = (v === 'æœ‰') ? 'block' : 'none';
    }
    async function submitForm() {
        if (!formData.driver_name || !formData.checker_name) return alert("æ°åã‚’é¸æŠã—ã¦ãã ã•ã„");
        const b = document.querySelector('.submit-btn'); b.disabled = true; b.innerText = "é€ä¿¡ä¸­...";
        try {
            await fetch(GAS_URL, { method: "POST", mode: "no-cors", body: JSON.stringify({...formData, instruction: document.getElementById('instruction').value}) });
            alert("å ±å‘Šå®Œäº†ï¼"); location.reload();
        } catch (e) { alert("ã‚¨ãƒ©ãƒ¼"); b.disabled = false; }
    }
</script>
</body>
</html>
