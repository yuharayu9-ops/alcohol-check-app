<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯å ±å‘Š</title>
    <style>
        body { font-family: sans-serif; background-color: #eef9ff; margin: 0; padding: 10px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #0077b6; border-bottom: 3px solid #caf0f8; padding-bottom: 10px; }
        .section-title { font-weight: bold; margin: 20px 0 10px; color: #023e8a; border-left: 8px solid #00b4d8; padding-left: 12px; }
        .btn-group { display: grid; gap: 8px; margin-bottom: 10px; grid-template-columns: 1fr 1fr; }
        .select-btn { padding: 18px 10px; border: 3px solid #e0e0e0; border-radius: 15px; background: #fff; cursor: pointer; font-size: 1.1em; font-weight: bold; text-align: center; color: #444; }
        .select-btn.active { background: #0077b6; color: white; border-color: #023e8a; }
        .select-btn.danger.active { background: #d90429; color: white; }
        .submit-btn { width: 100%; padding: 22px; background: #023e8a; color: white; border: none; border-radius: 60px; font-size: 1.5em; font-weight: bold; margin-top: 30px; }
        #alcohol-alert { display:none; color:white; background:#d90429; text-align:center; padding:15px; border-radius:10px; margin-top:10px; font-weight:bold; }
    </style>
</head>
<body>
<div class="container">
    <h2>ğŸšš ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯å ±å‘Š</h2>
    <div id="form-content">
        <div class="section-title">â° æœãƒ»å¤•ã®é¸æŠ</div>
        <div class="btn-group">
            <div class="select-btn active" onclick="sel('check_type','ä¹—å‹™å‰(æœ)',this)">æœ</div>
            <div class="select-btn" onclick="sel('check_type','ä¹—å‹™å¾Œ(å¤•)',this)">å¤•</div>
        </div>
        <div class="section-title">ğŸ‘¤ é‹è»¢è€…</div><div id="driver-buttons" class="btn-group"></div>
        <div class="section-title">ğŸš— è»Šä¸¡ï¼ˆæœªå®šãªã‚‰æ¬¡ã¸ï¼‰</div><div id="car-buttons" class="btn-group" style="grid-template-columns: 1fr;"></div>
        <div class="section-title">ğŸ· é…’æ°—å¸¯ã³</div>
        <div class="btn-group">
            <div class="select-btn active" onclick="selAlc('ç„¡',this)">ç„¡</div>
            <div class="select-btn danger" onclick="selAlc('æœ‰',this)">æœ‰</div>
        </div>
        <div id="alcohol-alert">âš ï¸ é…’æ°—å¸¯ã³ã€Œæœ‰ã€ã§ã™ï¼ç®¡ç†è€…ã«é€£çµ¡ã—ã¦ãã ã•ã„ã€‚</div>
        <div class="section-title">ğŸ‘® ç¢ºèªè€…</div><div id="checker-buttons" class="btn-group"></div>
        <button class="submit-btn" onclick="submitForm()">å ±å‘Šã‚’é€ä¿¡ï¼</button>
    </div>
</div>
<script>
    const GAS_URL = "https://script.google.com/macros/s/AKfycbz5JeYtgD7gZ0Ci9D9jNhVWmQGz7xrADb6EQiSunFQyKuHHaBq1DMHzM81_2VESSv01hQ/exec";
    let formData = { check_type: "ä¹—å‹™å‰(æœ)", driver_name: "", car_number: "æœªå®š", has_alcohol: "ç„¡", checker_name: "", method: "å¯¾é¢", use_device: "ä½¿ç”¨" };
    
    window.onload = async () => {
        const res = await fetch(GAS_URL); const d = await res.json();
        const create = (list, gid, key) => {
            const g = document.getElementById(gid);
            list.forEach((item, i) => {
                const b = document.createElement('div'); b.className = 'select-btn'; b.innerText = item;
                b.onclick = () => sel(key, item, b); g.appendChild(b);
                if (key === 'checker_name' && i === 0) { b.classList.add('active'); formData.checker_name = item; }
            });
        };
        create(d.drivers, 'driver-buttons', 'driver_name');
        create(d.cars, 'car-buttons', 'car_number');
        create(d.checkers, 'checker-buttons', 'checker_name');
    };

    function sel(k, v, e) {
        formData[k] = v;
        e.parentElement.querySelectorAll('.select-btn').forEach(b => b.classList.remove('active'));
        e.classList.add('active');
    }

    function selAlc(v, e) {
        formData.has_alcohol = v; sel('has_alcohol', v, e);
        document.getElementById('alcohol-alert').style.display = (v === 'æœ‰') ? 'block' : 'none';
    }

    async function submitForm() {
        if (!formData.driver_name) return alert("é‹è»¢è€…ã‚’é¸ã‚“ã§ãã ã•ã„");
        const b = document.querySelector('.submit-btn'); b.disabled = true; b.innerText = "é€ä¿¡ä¸­...";
        await fetch(GAS_URL, { method: "POST", mode: "no-cors", body: JSON.stringify(formData) });
        alert("å ±å‘Šå®Œäº†ï¼"); location.reload();
    }
</script>
</body>
</html>
